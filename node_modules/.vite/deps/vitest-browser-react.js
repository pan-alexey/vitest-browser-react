import {
  require_react_dom
} from "./chunk-JWUL5Q3R.js";
import {
  require_react
} from "./chunk-RKFR2PNI.js";
import {
  __commonJS,
  __toESM
} from "./chunk-DC5AMYBS.js";

// .yarn/__virtual__/react-dom-virtual-6839c2c67a/3/.yarn/berry/cache/react-dom-npm-18.3.1-a805663f38-10c0.zip/node_modules/react-dom/client.js
var require_client = __commonJS({
  ".yarn/__virtual__/react-dom-virtual-6839c2c67a/3/.yarn/berry/cache/react-dom-npm-18.3.1-a805663f38-10c0.zip/node_modules/react-dom/client.js"(exports) {
    "use strict";
    var m = require_react_dom();
    if (false) {
      exports.createRoot = m.createRoot;
      exports.hydrateRoot = m.hydrateRoot;
    } else {
      i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;
      exports.createRoot = function(c, o) {
        i.usingClientEntryPoint = true;
        try {
          return m.createRoot(c, o);
        } finally {
          i.usingClientEntryPoint = false;
        }
      };
      exports.hydrateRoot = function(c, h, o) {
        i.usingClientEntryPoint = true;
        try {
          return m.hydrateRoot(c, h, o);
        } finally {
          i.usingClientEntryPoint = false;
        }
      };
    }
    var i;
  }
});

// .yarn/__virtual__/vitest-browser-react-virtual-26c1e37b1b/3/.yarn/berry/cache/vitest-browser-react-npm-0.0.3-cca82bfcb8-10c0.zip/node_modules/vitest-browser-react/dist/chunk-SPD3VUIB.js
var import_react = __toESM(require_react(), 1);
var import_client = __toESM(require_client(), 1);
import { debug, getElementLocatorSelectors } from "@vitest/browser/utils";
function act(cb) {
  const act2 = import_react.default.act || import_react.default.unstable_act;
  if (!act2) {
    cb();
  } else {
    globalThis.IS_REACT_ACT_ENVIRONMENT = true;
    act2(cb);
    globalThis.IS_REACT_ACT_ENVIRONMENT = false;
  }
}
var mountedContainers = /* @__PURE__ */ new Set();
var mountedRootEntries = [];
function render(ui, { container, baseElement, wrapper: WrapperComponent } = {}) {
  if (!baseElement) {
    baseElement = document.body;
  }
  if (!container) {
    container = baseElement.appendChild(document.createElement("div"));
  }
  let root;
  if (!mountedContainers.has(container)) {
    root = createConcurrentRoot(container);
    mountedRootEntries.push({ container, root });
    mountedContainers.add(container);
  } else {
    mountedRootEntries.forEach((rootEntry) => {
      if (rootEntry.container === container) {
        root = rootEntry.root;
      }
    });
  }
  act(() => {
    root.render(
      strictModeIfNeeded(wrapUiIfNeeded(ui, WrapperComponent))
    );
  });
  return {
    container,
    baseElement,
    debug: (el, maxLength, options) => debug(el, maxLength, options),
    unmount: () => {
      root.unmount();
    },
    rerender: (newUi) => {
      act(() => {
        root.render(
          strictModeIfNeeded(wrapUiIfNeeded(newUi, WrapperComponent))
        );
      });
    },
    asFragment: () => {
      return document.createRange().createContextualFragment(container.innerHTML);
    },
    ...getElementLocatorSelectors(baseElement)
  };
}
function cleanup() {
  mountedRootEntries.forEach(({ root, container }) => {
    root.unmount();
    if (container.parentNode === document.body) {
      document.body.removeChild(container);
    }
  });
  mountedRootEntries.length = 0;
  mountedContainers.clear();
}
function createConcurrentRoot(container) {
  const root = import_client.default.createRoot(container);
  return {
    render(element) {
      root.render(element);
    },
    unmount() {
      root.unmount();
    }
  };
}
var config = {
  reactStrictMode: false
};
function strictModeIfNeeded(innerElement) {
  return config.reactStrictMode ? import_react.default.createElement(import_react.default.StrictMode, null, innerElement) : innerElement;
}
function wrapUiIfNeeded(innerElement, wrapperComponent) {
  return wrapperComponent ? import_react.default.createElement(wrapperComponent, null, innerElement) : innerElement;
}

// .yarn/__virtual__/vitest-browser-react-virtual-26c1e37b1b/3/.yarn/berry/cache/vitest-browser-react-npm-0.0.3-cca82bfcb8-10c0.zip/node_modules/vitest-browser-react/dist/index.js
import { page } from "@vitest/browser/context";
import { beforeEach } from "vitest";
page.extend({
  render,
  [Symbol.for("vitest:component-cleanup")]: cleanup
});
beforeEach(() => {
  cleanup();
});
export {
  cleanup,
  render
};
//# sourceMappingURL=vitest-browser-react.js.map
